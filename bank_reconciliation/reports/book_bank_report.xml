<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <template id="report_book_bank_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.basic_layout">
                        <div class="header" >
                                  <link rel="stylesheet" href='/bank_reconciliation/static/src/css/header.css'/>
                              <div class="col-8 pull-left">
<!--                                  <img t-att-src="'data:image/png;base64,%s' % to_text(o.company_id.logo)" width="100" height="80"/>-->
        <!--                          <h3><span t-field="o.company_id.name"/> </h3>-->
                                  <!--<h5><span t-field="o.company_id.street"/> </h5>-->
                                  <!--<h6> <span t-field="o.company_id.city"/> - <span t-field="o.company_id.country_id.name"/> </h6>-->
                              </div>
                              <!--Fecha y paginacion de hoja-->
                              <br>  </br>
                              <div class="datoscompa">
                                  <p><span t-field="o.company_id.name"></span></p>
                                  <p><span t-field="o.company_id.street"></span></p>
                                  <p><span t-field="o.company_id.city"></span>-<span t-field="o.company_id.country_id.name"></span></p>
                                  <p><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d/%m/%Y %H:%M')"/></p>
                                  <p><span>Pag: </span><span class="page" /> de <span class="topage" /></p>
                              </div>
                        </div>
                        <br></br>
                        <div class="filtros">
                            <p id="titulos">Libro Banco </p>
                            <p id="titulos">Usuario: <span t-field="user.name"/></p>
                            <p id="titulos">Banco: <span t-field="o.journal_id"/></p>
<!--                            <p id="titulos">Banco: <span t-field="o.journal_id"/></p>-->
                            <p id="titulos">Cuenta: <span t-field="o.account_id"/></p>
                            <p id="titulos">Fecha desde: <span t-field="o.date_from"/></p>
                            <p id="titulos">Fecha hasta: <span t-field="o.date_to"/></p>
                        </div>

                        <link rel="stylesheet" href='/bank_reconciliation/static/src/css/statement.css'/>
                        <br></br>
<!--                        <t t-set="saldo" t-value="o.saldo_anterior"/>-->

                    <div class="page" >
                        <div class="contenedor">
                            <div>
<!--                                <t t-if="'USD' in o.account_id.name">-->
<!--                                    <div>-->
<!--                                        <b style='font-size: 14px'> Saldo Inicial: <span t-esc="o.agregar_punto_de_miles(saldo,o.currency_id)"/></b>-->
<!--                                    </div>-->
<!--                                </t>-->
<!--                                <t t-else="">-->
<!--                                    <div>-->
<!--                                        <b style='font-size: 14px'> Saldo Inicial en Dolares: <span t-esc="o.saldo_en_dolares()"/></b>-->
<!--                                    </div>-->
<!--                                </t>-->
                            </div>
                            <br></br>
                            <t t-set="saldo_anterior" t-value="0"/>
                            <table class="tabla">
                                    <thead>
                                        <tr>
                                            <th>Empresa</th>
                                            <th>Referencia</th>
<!--                                            <th>Moneda de Importes</th>-->
<!--                                            <th>Fecha de Vencimiento</th>-->
                                            <th>Fecha contable</th>
                                            <th>Nro. Cheque</th>
                                            <th>Crédito</th>
                                            <th>Débito</th>
                                            <th>Saldo</th>
                                        </tr>
                                        <tr t-if="o.filter_wizard == 'all'">
                                            <th colspan="6" style="text-align:left;">Saldo Inicial</th>
                                            <th><span t-esc="o.calcular_saldo_anterior2()"/></th>
                                        </tr>
                                    </thead>
                            <t t-set="saldo_actual" t-value="saldo_anterior"/>
                            <t t-set="totalizador_credito" t-value="0"/>
                            <t t-set="totalizador_debito" t-value="0"/>
                            <t t-foreach="o.account_mvl_object2()" t-as="lines">
                                    <tbody>
                                        <t t-if="'USD' in o.account_id.name or '$' in o.account_id.name">
                                            <td><span t-field="lines.partner_id"/></td>
                                            <td><span t-field="lines.ref"/></td>
    <!--                                        <td><span t-field="lines.amount_currency"/></td>-->
<!--                                            <td><span t-field="lines.date_maturity"/></td>-->
                                            <td><span t-field="lines.date"/></td>
                                            <td><span t-field="lines.check_number"/></td>
<!--                                            // aqui se invierte el debito por el credito para que se vea como un libro banco contable-->
                                            <td><span t-field="lines.credito"/></td>
                                            <t t-set="totalizador_credito" t-value="totalizador_credito + lines.credito"/>
                                            <td><span t-field="lines.debito"/></td>
                                            <t t-set="totalizador_debito" t-value="totalizador_debito + lines.debito"/>
                                            <t t-set="saldo_actual" t-value="saldo_actual + (lines.debito - lines.credito)"/>
    <!--                                        <t t-set="monto_actual" t-value="lines.credito - lines.debito"/>-->
    <!--                                        <t t-set="saldo_anterior" t-value="saldo_anterior + monto_actual"/>-->
                                            <td><span t-esc="round(saldo_actual,4)"/></td>
                                        </t>
                                        <t t-else="">
                                            <td><span t-field="lines.partner_id"/></td>
                                            <td><span t-field="lines.ref"/></td>
    <!--                                        <td><span t-field="lines.amount_currency"/></td>-->
<!--                                            <td><span t-field="lines.date_maturity"/></td>-->
                                            <td><span t-field="lines.date"/></td>
                                            <td><span t-field="lines.check_number"/></td>
                                            <t t-set="totalizador_credito" t-value="totalizador_credito + lines.credito"/>
                                            <td><span t-esc="o.agregar_punto_de_miles(lines.credito,o.currency_id.name)"/></td>
                                            <t t-set="totalizador_debito" t-value="totalizador_debito + lines.debito"/>
                                            <td><span t-esc="o.agregar_punto_de_miles(lines.debito,o.currency_id.name)"/></td>
                                            <t t-set="saldo_actual" t-value="saldo_actual + (lines.debito - lines.credito)"/>
    <!--                                        <t t-set="monto_actual" t-value="lines.credito - lines.debito"/>-->
    <!--                                        <t t-set="saldo_anterior" t-value="saldo_anterior + monto_actual"/>-->
                                            <td><span t-esc="o.agregar_punto_de_miles(saldo_actual,o.currency_id.name)"/></td>
                                        </t>
                                    </tbody>
                            </t>
                                <tfoot>
                                    <tr>
                                            <th colspan="4"></th>
<!--                                            <th></th>-->
<!--                                            <th>Moneda de Importes</th>-->
<!--                                            <th>Fecha de Vencimiento</th>-->
<!--                                            <th></th>-->
<!--                                            <th></th>-->
<!--                                            <th></th>-->
                                            <th><span t-esc="round(totalizador_credito,4)"/></th>
                                            <th><span t-esc="round(totalizador_debito,4)"/></th>
                                            <th></th>
                                        </tr>
                                </tfoot>
                            </table>
                            <br/>
                            <br/>
                            <br/>
                            <div class="row">
                               <div class="col-6">
                                   <b><span>Hecho Por: </span></b>
                               </div>
                               <br/>
                               <br/>
                              <div class="col-6">
                                   <b><span>Verificado Por: </span></b>
                               </div>
                            </div>
                        </div>
                    </div>
                    </t>
                </t>
            </t>
        </template>

    </data>
</odoo>