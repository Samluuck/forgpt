<odoo>
  <template id="libro_mayor_paraguay_report">
    <t t-call="web.html_container">
          <t t-foreach="docs" t-as="o">
              <t t-call="web.basic_layout">
                   <t t-set="cantidad_debito" t-value="0"/>
                  <t t-set="cantidad_credito" t-value="0"/>
                  <div class="page" >
                      <link rel="stylesheet" href="/accounting_reports_paraguay/static/src/css/libro_mayor.css"/>
                  <div class="contenedor"/>
                      <t t-set="cuenta_actual"/>
                      <t t-set="longitud" t-value="0"/>
                      <t t-set="debito_cuenta" t-value="0"/>
                      <t t-set="credito_cuenta" t-value="0"/>
                      <t t-set="saldo_cuenta" t-value="0"/>
                      <t t-set="saldo" t-value="0"/>
                          <table class="tabla">
                              <thead>
                                  <tr>
                                      <th>Fecha</th>
                                      <th>Ref.</th>
                                      <th>Detalles</th>
                                      <th>Debito</th>
                                      <th>Credito</th>
                                      <th>Saldos</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <t t-foreach="lineas" t-as="l">
                                      <t t-if="l.account_id != cuenta_actual">
                                           <t t-set="longitud" t-value="0"/>
                                          <t t-set="debito_cuenta" t-value="0"/>
                                          <t t-set="credito_cuenta" t-value="0"/>
                                          <t t-set="saldo_cuenta" t-value="0"/>
                                          <t t-set="saldo" t-value="o.saldo_al_dia(l.account_id)"/>
                                          <t t-set="longitud" t-value="longitud + 1"/>
                                          <t t-set="cuenta_actual" t-value="l.account_id"/>
                                          <tr>
                                              <td colspan="4" class="negrita izquierda" ><span t-field="l.account_id.code"/>   <span t-field="l.account_id.name"/></td>
                                              <td  class="negrita izquierda" >Saldo Inicial</td>
                                              <td  class="negrita izquierda" ><span t-esc="o.agregar_punto_de_miles(saldo)"/></td>
                                          </tr>
                                          <tr>
                                              <td><span t-field="l.date"/></td>
                                              <td><span t-field="l.move_id.num_asiento"/> </td>
                                              <t t-if="l.move_id.ref">
                                                  <td ><span t-field="l.move_id.ref"/></td>
                                              </t>
                                              <t t-else="">
                                                  <td ><span t-field="l.name"/></td>
                                              </t>
                                              <td><span t-esc="o.agregar_punto_de_miles(l.debit)"/> </td>
                                              <t t-set="cantidad_debito" t-value="cantidad_debito + l.debit"/>
                                              <td><span t-esc="o.agregar_punto_de_miles(l.credit)"/> </td>
                                              <t t-set="cantidad_credito" t-value="cantidad_credito + l.credit"/>
                                              <t t-set="saldo" t-value="saldo + l.balance"/>
                                              <td><span t-esc="o.agregar_punto_de_miles(saldo)"/> </td>
                                              <t t-set="debito_cuenta" t-value="debito_cuenta + l.debit"/>
                                              <t t-set="credito_cuenta" t-value="credito_cuenta + l.credit"/>
                                              <t t-set="saldo_cuenta" t-value="saldo_cuenta + saldo"/>
                                          </tr>
                                      </t>
                                      <t t-else="">
                                          <t t-set="longitud" t-value="longitud + 1"/>
                                          <tr>
                                              <td><span t-field="l.date"/></td>
                                              <td><span t-field="l.move_id.num_asiento"/> </td>
                                              <t t-if="l.move_id.ref">
                                                  <td ><span t-field="l.move_id.ref"/></td>
                                              </t>
                                              <t t-else="">
                                                  <td ><span t-field="l.name"/></td>
                                              </t>
                                              <td><span t-esc="o.agregar_punto_de_miles(l.debit)"/> </td>
                                              <t t-set="cantidad_debito" t-value="cantidad_debito + l.debit"/>
                                              <td><span t-esc="o.agregar_punto_de_miles(l.credit)"/> </td>
                                              <t t-set="cantidad_credito" t-value="cantidad_credito + l.credit"/>
                                              <t t-set="saldo" t-value="saldo + l.balance"/>
                                              <td><span t-esc="o.agregar_punto_de_miles(saldo)"/> </td>
                                              <t t-set="debito_cuenta" t-value="debito_cuenta + l.debit"/>
                                              <t t-set="credito_cuenta" t-value="credito_cuenta + l.credit"/>
                                              <t t-set="saldo_cuenta" t-value="saldo_cuenta + saldo"/>
                                          </tr>
                                      </t>
                                      <t t-if="longitud == o.cantidad_cuenta(l.account_id.id)">
                                          <tr class="negrita">
                                              <td colspan="3"><span style="font-weight:bold;">Totales:</span></td>
                                              <td><span t-esc="o.agregar_punto_de_miles(debito_cuenta)"/></td>
                                              <td><span t-esc="o.agregar_punto_de_miles(credito_cuenta)"/></td>
                                              <t t-set="saldo_cuenta" t-value="debito_cuenta - credito_cuenta"/>
                                              <td><span t-esc="o.agregar_punto_de_miles(saldo_cuenta)"/></td>
                                          </tr>
                                      </t>
                                  </t>

                              </tbody>
                          </table>

                   </div>
                <div class="footer" style="position:absolute; margin:0px; padding:0px">
                   <table>
                       <tr>
                                      <td style="font-weight:bold" colspan="5">Transporte</td>
                                      <td style="font-weight:bold"><span t-esc="o.agregar_punto_de_miles(cantidad_debito)"/></td>
                                      <td style="font-weight:bold"><span t-esc="o.agregar_punto_de_miles(cantidad_credito)"/></td>
                       </tr>
                   </table>
                </div>
                   </t>
          </t>
    </t>
  </template>
</odoo>